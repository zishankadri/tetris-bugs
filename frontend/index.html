<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">

    <title>Code Editor - Tetris</title>

    <link rel="stylesheet" href="https://pyscript.net/releases/2025.8.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2025.8.1/core.js"></script>

    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/menu.css">
</head>

<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content retro-shadow">
            <h1 class="font-retro" style="color: lime; margin-bottom: 20px;">Tetris Bugs</h1>
            <div class="loading-spinner"></div>
            <p class="font-retro" style="color: lime; margin-top: 20px;">Loading...</p>
        </div>
    </div>

    <!-- Modal markup directly in HTML -->
    <div id="modal-bg" class="modal-bg">
        <div class="modal retro-shadow">
            <div class="font-retro">
                Type max 4 characters. <br>
                press Enter to spawn a block. <br>
                Use ⬅️ ➡️ to move, _Space_ to lock.
            </div>
            <button id="continue-btn" class="continue-btn font-retro">Continue</button>
        </div>
    </div>

    <div class="top-bar">
        <h1 class="font-retro">Tetris Bugs</h1>
    </div>

    <div id="wrapper">

        <div class="text-bar">
            <input type="text" id="text-input" maxlength="4" placeholder="Type code" class="retro-input" autofocus/>
            <p id="timer" class="font-retro"></p>
            <button id="save-btn" class="retro-btn">Export File</button>
        </div>

        <!-- Grid -->
        <div id="game" class="retro-shadow"></div>
    </div>

    <!-- pyscript -->
    <script type="py" src="./main.py" config="config.json"></script>

    <!-- simple javascript to add a loading screen -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {

            const checkPyScript = setInterval(function() {
                if (window.pyodide && window.pyodide.isReady) {
                    clearInterval(checkPyScript);
                    hideLoadingScreen();
                }
            }, 100);

            setTimeout(function() {
                clearInterval(checkPyScript);
                hideLoadingScreen();
            }, 5000);
        });

        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
                loadingScreen.classList.add('hidden');
            }
        }
    </script>
</body>

</html>
